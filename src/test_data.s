
;
; Test track. It's Freddie Hubbard's "Straight Life".
;

TEST_LENGTH = 6
TEST_TIMER = 080h

;
;
;
avm_data_test_bass_init_sub:
	db	AVM_TIMER, TEST_TIMER
	db	AVM_INST, 2
	db	AVM_LENGTH, TEST_LENGTH
	db	AVM_OCT, 3*8
	db	AVM_RET

avm_data_test_bass_echo:
	db	AVM_CALL
	dw	avm_data_test_bass_init_sub
	db	AVM_PAN, OPN_PAN_R
	db	AVM_VOL, 03h
	db	AVM_REST, TEST_LENGTH/2
	db	AVM_JUMP
	dw	avm_data_test_bass.loop

avm_data_test_bass:
	db	AVM_CALL
	dw	avm_data_test_bass_init_sub
	db	AVM_PAN, OPN_PAN_L
	db	AVM_VOL, 00h
.loop:
	db	AVM_CALL
	dw	.ptest_sub
	db	AVM_JUMP
	dw	.loop
	db	AVM_CALL
	dw	.pt1_sub
	db	AVM_JUMP
	dw	.loop

.pt1_sub:
	db	AVM_NOTE_C
	db	AVM_REST, 0
	db	AVM_NOTE_E
	db	AVM_NOTE_G
	db	AVM_OCT_UP, AVM_NOTE_C, AVM_OCT_DOWN
	db	AVM_NOTE_G
	db	AVM_NOTE_C

	db	AVM_OCT_DOWN, AVM_NOTE_Bb
	db	AVM_REST, 0
	db	AVM_NOTE_Bb, AVM_OCT_UP
	db	AVM_NOTE_D
	db	AVM_NOTE_F
	db	AVM_NOTE_Bb
	db	AVM_NOTE_F
	db	AVM_OCT_DOWN, AVM_NOTE_Bb
	db	AVM_REST, 0
	db	AVM_OCT_UP
	dw	AVM_RET

.ptest_sub:
	db	AVM_LENGTH, 020h
	db	AVM_NOTE_C
	db	AVM_SLIDE, 10h
	db	AVM_NOTE_E
	db	AVM_NOTE_G
	db	AVM_OCT_UP, AVM_NOTE_C, AVM_OCT_DOWN
	db	AVM_SLIDE, 40h
	dw	AVM_RET

;
;
;
avm_data_test_lead_init_sub:
	db	AVM_TIMER, TEST_TIMER
	db	AVM_INST, 0
	db	AVM_LENGTH, TEST_LENGTH
	db	AVM_OCT, 5*8
	db	AVM_RET

avm_data_test_lead_echo:
	db	AVM_CALL
	dw	avm_data_test_lead_init_sub
	db	AVM_PAN, OPN_PAN_L
	db	AVM_VOL, 12h
	db	AVM_REST, TEST_LENGTH
	db	AVM_JUMP
	dw	avm_data_test_lead.loop

avm_data_test_lead:
	db	AVM_CALL
	dw	avm_data_test_lead_init_sub
	db	AVM_PAN, OPN_PAN_R
	db	AVM_VOL, 00h
.loop:
	db	AVM_LOOPSET, 2
	db	AVM_CALL
	dw	.pt1_sub
	db	AVM_CALL
	dw	.pt1_sub
	db	AVM_CALL
	dw	.pt2_sub
	db	AVM_JUMP
	dw	.loop

.pt1_sub:
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*3
	db	AVM_NOTE_Eb
	db	AVM_NOTE_E
	db	AVM_NOTE_D
	db	AVM_NOTE_C | AVM_NOTE_REST_FLAG, TEST_LENGTH*2

	db	AVM_NOTE_D | AVM_NOTE_REST_FLAG, TEST_LENGTH*3
	db	AVM_NOTE_C
	db	AVM_NOTE_D
	db	AVM_NOTE_C, AVM_OCT_DOWN
	db	AVM_NOTE_Bb | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_Bb | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_OCT_UP
	db	AVM_NOTE_C | AVM_NOTE_REST_FLAG, TEST_LENGTH*11
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_Eb
	dw	AVM_RET

.pt2_sub:
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_F | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_G | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_A
	db	AVM_NOTE_As, AVM_NOTE_OFF
	db	AVM_REST, TEST_LENGTH*8
	db	AVM_NOTE_As | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_A | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_G | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_F
	db	AVM_NOTE_G, AVM_NOTE_OFF
	db	AVM_REST, TEST_LENGTH*8
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_F | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_G | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_A | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_As | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_A | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_G | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_F | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_G | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_Eb
	db	AVM_NOTE_E, AVM_NOTE_OFF
	db	AVM_REST, TEST_LENGTH*3
	db	AVM_NOTE_E | AVM_NOTE_REST_FLAG, TEST_LENGTH*2
	db	AVM_NOTE_D
	db	AVM_NOTE_C
	db	AVM_OCT_DOWN, AVM_NOTE_Bb, AVM_OCT_UP
	db	AVM_RET

avm_data_test_sweeps:
	db	AVM_CALL
	dw	avm_data_test_bass_init_sub

	; octave sweep
	db	AVM_OCT, 0
	db	AVM_LENGTH, 30
	db	AVM_NOTE_C
	rept	7
	db	AVM_NOTE_C, AVM_OCT_UP
	endm
	; note sweep
	db	AVM_OCT, 3*8
	db	AVM_LENGTH, 40
	db	AVM_NOTE_C
	db	AVM_NOTE_Cs
	db	AVM_NOTE_D
	db	AVM_NOTE_Ds
	db	AVM_NOTE_E
	db	AVM_NOTE_F
	db	AVM_NOTE_Fs
	db	AVM_NOTE_G
	db	AVM_NOTE_Gs
	db	AVM_NOTE_A
	db	AVM_NOTE_As
	db	AVM_NOTE_B
	db	AVM_OCT_UP, AVM_NOTE_C | AVM_NOTE_REST_FLAG, 48
	
